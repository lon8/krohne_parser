# Проект для обработки серийных номеров с использованием API Krohne

## Описание

Этот проект предназначен для загрузки серийных номеров из Excel-файла, отправки запросов к API Krohne и записи результатов в новый Excel-файл. Проект использует многопроцессорную обработку и многопоточность для параллельной обработки данных, а также логирование с помощью библиотеки `loguru`.

## Требования

Перед запуском убедитесь, что на вашей системе установлены следующие компоненты:

- Python 3.7 или новее
- Виртуальное окружение (рекомендуется)

## Установка

1. Склонируйте репозиторий на свою локальную машину:

    ```bash
    git clone https://github.com/lon8/krohne_parser.git
    cd krohne_parser
    ```
2. Создайте и активируйте виртуальное окружение (опционально):
    
    ```bash
    python3 -m venv venv
    source venv/bin/activate  # Для Linux/MacOS
    venv\Scripts\activate  # Для Windows
    ```
3. Установите необходимые зависимости:
    ```bash
    pip install -r requirements.txt
    ```
4. Переместите файл .xslx в krohne_parser и переименуйте в "input_file.xlsx"

5. Создайте пустой файл "output_file.xlsx"


## Запуск
1. Убедитесь, что у вас активировано виртуальное окружение (если использовалось).

2. Запустите основной скрипт, указав входной и выходной файлы:

    ```bash
    python main.py
    ```

По умолчанию программа будет искать входной файл с именем input_file.xlsx и создаст выходной файл с именем output_file.xlsx. Если хотите использовать другие файлы, измените их имена в коде или передайте их в качестве аргументов.

## Логирование
Все события процесса логируются в файл app.log. Файл лога автоматически ротируется (создается новый файл, если текущий достигает 10 MB).

## Прогресс
Во время выполнения вы можете наблюдать прогресс обработки серийных номеров и записи данных в файл благодаря использованию библиотеки tqdm.

## Возможные проблемы

### API возвращает некорректные данные:
Если API возвращает неожиданный формат данных, программа пропустит такие данные и запишет это в лог.

### Проблемы с соединением:
В случае ошибок сети запрос будет пропущен и записан в лог.

## Пояснения:

- **Установка и конфигурация:** Включены инструкции по клонированию репозитория, установке зависимостей и созданию виртуального окружения.
- **Запуск:** Описано, как запустить скрипт и какие файлы используются по умолчанию.
- **Логирование:** Подробности о логировании процесса с помощью `loguru`.
- **Прогресс:** Указано, что прогресс выполнения отображается с помощью `tqdm`.
- **Возможные проблемы:** Краткие советы по устранению возможных проблем.

Этот `README.md` должен дать пользователям все необходимые инструкции для работы с проектом.